<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='wmkssdk/css/wmks-all.css') }}">
<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.js"></script>
<script type="text/javascript" src="http://code.jquery.com/ui/1.8.16/jquery-ui.js"></script>
<script src="{{ url_for('static', filename='wmkssdk/wmks.js') }}"></script>
<!-- ><script type="text/javascript" src="https://vcenter.nsxlab.local:9443/vsphere-client/js/wmks.js" type="text/javascript"></script>-->

<div  id="container" style="width:100%; height:700px;"></div>

<script>
var options = {
    //rescale: true,
    //enableUint8Utf8: false,
    enableVVC: true,
    useVNCHandshake: false,
    //retryConnectionInterval: 1000,
    //keyboardLayoutId: 'it-IT',
    //changeResolution: true,
    sendProperMouseWheelDeltas: true
}
var wmks = WMKS.createWMKS("container", options);
console.log(wmks.getVersion())

wmks.register(WMKS.CONST.Events.CONNECTION_STATE_CHANGE, function(event, data){
    console.log(event)
    console.log(data)
    if(data.state == WMKS.CONST.ConnectionState.CONNECTED) {
        console.log("connection state change : connected");
    }
});

wmks.register(WMKS.CONST.Events.ERROR, function(event, data){
    console.log(event)
    console.log(data)
});



var ip = "172.25.3.10";
//var path = ":9443/vsphere-client/webconsole";

var vmId = 'vm-83';
var vmName = 'tst-vm2';
var serverGuid = '64b9af30-f59d-4e86-9e07-0cba501e1d5a';
var server = 'vcenter.nsxlab.local';
var path = ":443/vsphere-client/webconsole";
var ticket = 'cst-VCT-52e03e3b-dca2-bce1-610b-75a3225d44bf--tp-13-9D-7B-AF-52-80-7D-51-4F-13-A3-A3-16-C0-B9-3B-3F-54-3C-B9';
var thumbprint = '13:9D:7B:AF:52:80:7D:51:4F:13:A3:A3:16:C0:B9:3B:3F:54:3C:B9';
var authd = 'vmId='+ vmId + '&vmName=' + vmName + '&serverGuid=' +serverGuid + '&host=' + server + ':443&sessionTicket=' + ticket + '&thumbprint=' + thumbprint;
var uri = 'wss://' + server + path + '/authd?' + authd;
//var uri = 'wss://' + server + path + authd;
//var uri = 'wss://vcenter.nsxlab.local:9443/vsphere-client/webconsole/authd?'
uri = 'wss://vcenter.nsxlab.local:9443/vsphere-client/webconsole/authd?vmId=vm-205&vmName=tst-vm2&serverGuid=64b9af30-f59d-4e86-9e07-0cba501e1d5a&host=vcenter.nsxlab.local:443&sessionTicket=cst-VCT-526a734f-022b-35cf-4bf7-05be35da5533--tp-13-9D-7B-AF-52-80-7D-51-4F-13-A3-A3-16-C0-B9-3B-3F-54-3C-B9&thumbprint=13:9D:7B:AF:52:80:7D:51:4F:13:A3:A3:16:C0:B9:3B:3F:54:3C:B9'

/*
var ESXhost = 'esx6-r610-n01.nuvolacsi.it';
var ESXhost = 'esx-lab1-1.nuvolacsi.it';
var TICKETNUMBER = '520cb568-cec6-fb28-fa1f-87d5707f4445'
var port = '443'
var port = '902'
var path = '?host=esx-lab1-1.nuvolacsi.it&port=902&ticket=52e94443-c812-f683-e3aa-6965e543089b&cfgFile=/vmfs/volumes/56a24960-6cc35ef5-456d-d4bed9a947fe/NSX_Controller_db83ca66-b8fd-4a84-8c3e-b2b7e884d154/NSX_Controller_db83ca66-b8fd-4a84-8c3e-b2b7e884d154.vmx&thumbprint=38:65:5F:D4:5D:99:35:32:1C:F9:2D:4E:B2:37:DB:17:78:F3:0B:BA';
uri = 'wss://'+ESXhost+':'+port+'/ticket/'+TICKETNUMBER;
uri = 'wss://'+ESXhost+':'+port+'/'+path;
*/
console.log('{{uri|safe}}')
wmks.connect('{{uri|safe}}');
//wmks.connect(ESXhost, "", false, TICKETNUMBER, "", "", vmId, "", "");

</script >